extends ../../layouts/default

block main
  .order-success.container
    h2.text-success.mt-4 ‚úÖ Chi ti·∫øt ƒë∆°n h√†ng #{order._id}
    .alert.alert-info
      | B·∫°n c√≥ th·ªÉ xem chi ti·∫øt ƒë∆°n h√†ng b√™n d∆∞·ªõi.

    // Tr·∫°ng th√°i ƒë∆°n h√†ng hi·ªÉn th·ªã text, c√≥ n√∫t s·ª≠a
    .mb-4.d-flex.align-items-center.justify-content-between
      .fw-bold
        | Tr·∫°ng th√°i ƒë∆°n h√†ng: 
        span.text-primary
          if order.status === 'pending'
            | ƒêang x·ª≠ l√Ω
          else if order.status === 'shipping'
            | ƒêang giao
          else if order.status === 'delivered'
            | ƒê√£ giao
          else if order.status === 'cancelled'
            | ƒê√£ h·ªßy
          else if order.status === 'completed'
            | Ho√†n th√†nh
          else
            | Kh√¥ng x√°c ƒë·ªãnh
      //- a.btn.btn-sm.btn-warning(href=`edit/${order._id}`) Ch·ªânh s·ª≠a

    // Th√¥ng tin c√° nh√¢n
    .order-info.mt-4
      h5 üìã Th√¥ng tin c√° nh√¢n
      table.table.table-bordered.mt-2
        tr
          th H·ªç t√™n
          td= order.userInfo.fullName
        tr
          th S·ªë ƒëi·ªán tho·∫°i
          td= order.userInfo.phone
        tr
          th ƒê·ªãa ch·ªâ
          td= order.userInfo.address
        tr
          th Ph∆∞∆°ng th·ª©c thanh to√°n
          td= order.paymentMethod === 'cod' ? 'Thanh to√°n khi nh·∫≠n h√†ng (COD)' : 'VNPay (ƒë√£ thanh to√°n)'

    // Danh s√°ch s·∫£n ph·∫©m
    .product-list.mt-5
      h5 üõí Chi ti·∫øt ƒë∆°n h√†ng
      table.table.table-striped.table-hover.product-table
        thead.table-light
          tr
            th ·∫¢nh
            th S·∫£n ph·∫©m
            th ƒê∆°n gi√°
            th Gi·∫£m gi√°
            th Gi√° sau gi·∫£m
            th S·ªë l∆∞·ª£ng
            th Th√†nh ti·ªÅn
        tbody
          each product in order.products
            tr
              td
                if product.thumbnail
                  img(src=product.thumbnail, alt=product.title, width="60", height="60", style="object-fit: cover; border-radius: 6px;")
                else
                  span.text-muted Kh√¥ng c√≥ ·∫£nh
              td= product.title || "S·∫£n ph·∫©m kh√¥ng r√µ"
              td= product.price.toLocaleString() + ' ƒë'
              td= (product.discountPercentage || 0) + '%'
              - const newPrice = product.price * (1 - (product.discountPercentage || 0) / 100);
              td= newPrice.toLocaleString() + ' ƒë'
              td= product.quantity
              td= (newPrice * product.quantity).toLocaleString() + ' ƒë'
          tr.total-row
            td(colspan="6", class="text-end fw-bold") T·ªïng ti·ªÅn:
            td.text-danger.fw-bold #{order.totalPrice.toLocaleString()} ƒë

  style.
    .order-success {
      max-width: 800px;
      margin: 40px auto;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .order-success h2 {
      color: #28a745;
      margin-bottom: 20px;
    }
    .order-info, .product-table {
      margin-top: 30px;
    }
    .product-table th, .product-table td {
      vertical-align: middle;
    }
    .total-row {
      font-weight: bold;
      color: #d9534f;
    }
